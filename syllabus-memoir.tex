%%% syllabus-memoir.tex
%%% Pandoc template using LaTeX memoir class
%%% For creating PDF from .md file with YAML frontmatter 
%%% Created by Eric M. Fink (https://github.com/LuckyJimJD/pandoc-templates)
%%% 


% ====================
% = Layout & Spacing =
% ====================

\documentclass[letterpaper,11pt,twoside]{memoir}

\settypeblocksize{9in}{6in}{*}
\setlrmargins{1.25in}{*}{1} % {inside margin}{outside margin} {ratio}
\setulmargins{1in}{*}{1} % {top margin}{bottom margin} {ratio}

\setheadfoot{\baselineskip}{1\onelineskip} % headheight and footskip
\setheaderspaces{*}{*}{0.5} % headdrop, headsep, and ratio

\checkandfixthelayout[lines]

\openright

\usepackage[defaultlines=4,all]{nowidow}
\raggedbottom

\SingleSpacing

\usepackage{ragged2e}
\setlength{\RaggedRightParindent}{0em}
\RaggedRight
\usepackage[none]{hyphenat}

\usepackage{parskip}
\setlength{\parindent}{0em}
\setlength{\parskip}{0.6em plus 0.2em minus 0.1em}

\setlength{\emergencystretch}{3em}  % prevent overfull lines

\usepackage[hang,flushmargin]{footmisc} 

\usepackage{needspace}% http://ctan.org/pkg/needspace


% ============
% = Language =
% ============

\usepackage[english]{babel}  


% ==================
% = Colors & Fonts =
% ==================

\usepackage{xcolor}
\definecolor{myblack}{HTML}{231F20} 
\definecolor{mybrightred}{HTML}{EC1F27} 
\definecolor{mydarkred}{HTML}{b03a2e} 
\definecolor{mydarkblue}{HTML}{154360}
\definecolor{mylightblue}{HTML}{3498DB} 

\usepackage{fontspec}

\setmainfont{Cormorant Garamond}[Mapping={tex-text},SmallCapsFont={Cormorant SC}]
\setsansfont{Proza Libre}[Mapping=tex-text]
\setmonofont{Cousine}[Mapping=tex-text,Scale=0.8]
\newfontface\titlefont{Proza Libre Bold}[Colour=mydarkred]
\newfontface\chapterfont{Proza Libre Bold}[Colour=mydarkred]

\usepackage{textcomp}
\usepackage{fontawesome}
\newfontfamily{\FA}{[FontAwesome.otf]}


% =======================
% = Headers and Footers = 
% =======================

% custom date format for header and footer 
\usepackage[us, nodayofweek]{datetime}
\newdateformat{mydate}{\THEDAY \ \monthname \ \THEYEAR}

\nouppercaseheads
\makepagestyle{stylish}
\copypagestyle{stylish}{headings}
\makerunningwidth{stylish}{$typeblockwidth$}
\makeheadposition{stylish}{flushleft}{flushright}{}{}
\pagestyle{stylish}

\makeevenhead{stylish}{\thepage}{$title$}{$term$}
\makeoddhead{stylish}{$author$}{$affiliation$}{\thepage}
$if(path)$
\makeevenfoot{stylish}{$path$}{}{Revised: \today}
\makeoddfoot{stylish}{$path$}{}{Revised: \today}
$else$
\makeevenfoot{stylish}{}{}{Revised: \today}
\makeoddfoot{stylish}{}{}{Revised: \today}
$endif$


% =========
% = Lists =
% =========

\usepackage{enumitem}
\setlistdepth{6}

\setlist[itemize,1]{label=\textbullet}
\setlist[itemize,2]{label=\textopenbullet}
\setlist[itemize,3]{label=\textbullet}
\setlist[itemize,4]{label=\textopenbullet}
\setlist[itemize,5]{label=\textbullet}
\setlist[itemize,6]{label=\textopenbullet}


\providecommand{\tightlist}{%
\setlength{\itemsep}{0em}\setlength{\parskip}{0em}\setlength{\itemindent}{0em}}


% ============
% = Headings =
% ============


\setsecnumdepth{subsubsection}
\counterwithout{section}{chapter}



% H1

\renewcommand{\clearforchapter}{}
\pagestyle{myheadings}
\chapterstyle{default}
\renewcommand*{\chapterheadstart}{%
  \par
  \needspace{5\onelineskip}
  \vspace{\beforechapskip}
  }
\setlength{\beforechapskip}{2em}
\renewcommand*{\printchaptername}{}
\renewcommand*{\chapternamenum}{}
\renewcommand*{\printchapternum}{}
\renewcommand*{\chaptitlefont}{\chapterfont\LARGE}
\renewcommand*{\printchaptertitle}[1]{\chaptitlefont #1 \rule[0em]{\textwidth}{0.5pt}}
\setlength{\afterchapskip}{0.5em}


% H2
\setsecheadstyle{\sffamily\bfseries\Large}
\setbeforesecskip{3em}
\setaftersecskip{1em}

% H3
\setsubsecheadstyle{\large\bfseries\sffamily}
\setbeforesubsecskip{1.5em}
\setaftersubsecskip{0.5em}

% H4
\setsubsubsecheadstyle{\normalsize\bfseries\sffamily}
\setbeforesubsubsecskip{1.5em}
\setaftersubsubsecskip{0.5em}

% H5
\setparaindent{0em}
\setparaheadstyle{\large\bfseries\sffamily}
\setbeforeparaskip{1.5em}
\setafterparaskip{0.5em}

% H6
\setsubparaindent{0em}
\setsubparaheadstyle{\large\rmfamily\itshape}
\setbeforesubparaskip{0.5em}
\setaftersubparaskip{0.2em}



% ==========
% = Quotes =
% ==========

\usepackage{csquotes}

\AtBeginEnvironment{quote}
  {\itshape\small\list{}{\rightmargin=-1.5em \leftmargin=-1.5em}\item\relax}{\endlist}


% ============
% = Graphics =
% ============

\usepackage{caption}
\captionsetup[figure]{labelformat=empty}

$if(graphics)$
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
$endif$



% ================
% = Title Layout =
% ================
\usepackage{titling}
\setlength{\droptitle}{-2cm}
\pretitle{\begin{flushleft}}
\DeclareRobustCommand{\titling}{
\Huge\bfseries{\titlefont{$course$}} \\
\vspace{1em}
\footnotesize{$affiliation$}  \\
\footnotesize{$term$}  \\
$if(days)$
\footnotesize{$days$}  \\
$endif$
$if(room)$
\footnotesize{$room$} \\ 
$endif$
\vspace{1em}
\footnotesize{$author$}  \\
\footnotesize\texttt{\href{mailto:{$email$}}{$email$}}  \\
\footnotesize{$phone$}  \\
\footnotesize{Office Hours: }\href{https://calendly.com/emfink}{\texttt{calendly.com/emfink}} 
}
\title{\titling}
\posttitle{\end{flushleft}}
\date{}

% ==============
% = Hyperlinks =
% ==============

\usepackage[unicode=true]{hyperref}
\hypersetup{colorlinks=true, allcolors=mydarkblue}

% ==============================================================================
% =============================== BEGIN DOCUMENT =============================== 
% ==============================================================================

\begin{document}\thispagestyle{empty}

\maketitle
\vspace{-2cm}

\needspace{3em}% Controls page break before headings 




$body$

\end{document}
